### 二手房列表页Review
___

#### 现状问题分析:

* 聚合
    * 查询和聚合查询调用solr在一起,这样会增加solr超时时间，且合在一起在查询无房源时是不值得的，因为没有房源时不需要聚合,导致GET请求solr字段太长
    * 从代码结构来说:不太好维护,不太好加断点监控
    * 聚合在facetRewrite写得太死，所有字段都聚合，每个平台用的是都是所有字段聚合，不方便定制
    * 聚合后的结果controller做得太多事情，不方便公用
    * 根据不同的业务聚合写在了搜索底层
    
* 推广业务
    
    * 分页问题，每个条件的前台显示精选（竞价）房源，翻至第二页时定价位移有问题
    * 显示精选数量写在了Rewirte里了，导致pc和touchweb无法定制
    * 业务逻辑查询多少竞价等写在了搜索底层
    
#### 后续改进

* 聚合：
    * 查询和聚合分开
    * 聚合可定制，不同的业务通过可配置要聚合哪些项
    * solr的聚合只做聚合数量的查询，增加biz来生成筛选的url，根据聚合后的数量做不同处理，要不要显示
    
* 推广业务
    * 要不要查询竞价房源由biz确定
    * 显示多少竞价数量由biz确定，不同的平台，业务是不一样的
    * 翻页如果之前查询了竞价，翻页时要再查一次，才来算出定价的偏移量
* 监控
    * 增加断点监控
