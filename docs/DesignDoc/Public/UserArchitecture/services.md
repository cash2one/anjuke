
实线是api直接读写，虚线是消息拉取

### 红色表示一个核心服务

每个核心服务提供一个数据资源的增删改查。核心服务内部采用何种技术栈(java/php/python/ruby etc)不做强制要求，但是必须要满足下面的要求

* 使用统一的服务协议，APS/HTTP
* 该服务涉及的所有表只能自己读写，禁止任何其他应用读取。该服务也禁止读取任何其他的表
* 自己维护完整的缓存机制
* 数据的新增/更新/删除都要主动对外推送消息。同时确保消息发送之前，api的缓存就已经更新(避免消息出去了过了几毫秒甚至几秒以后，api返回的数据才更新)
* 符合ajk标准的api，包括传入和返回参数，状态码等。参数的格式为了满足跨语言的需求必须标准化。例如json，经常有对象有数据时返回的\{\},空数据返回\[\],应该在任何情况下都返回{}，或者直接是null，或者直接删去这个字段
* 符合ajk标准的api粒度
* 核心服务可以包含自己的job。这些job同样也只能读取自己的表，涉及别的数据源的数据只能走api或者消息
* 原则上一个核心服务的api不应该直接依赖另外一个核心服务的api。如果有需要，应该通过job的方式，接收另一个核心服务的消息，在job中请求api获取需要的数据，再写入该服务自己的表中(最好调用自己服务的api来写入数据)


### 紫色表示应用业务，用来组合多个核心服务

* 用来组合多个数据源的数据，按照业务需求进行整理返回。主要的业务逻辑应该都包含在此
* 应用可以是服务，也可以是一个代码模块
* 可以有自己的表，但是这个表同样只能自己读写。禁止读写别人的表
* 如需要，自己维护完整的缓存机制
* 如需要，向外主动推送消息
* 如果是服务，需要符合ajk标准的api及粒度
* 可以有自己的job。同样只能读取自己的表，涉及别的数据源的数据只能走api或消息

### 黄色表示前台页面，调用多个核心服务或者应用服务，展示数据

* 严格禁止直接读表
* 可以调用多个api或者通过应用业务(紫色)的模块来获取数据