## 大业主发房设计
---
### 需求

prd经过多次修改，本设计将以上线版本为准

* 小区信息模块
    * 发布房源时，小区名使用安居客小区名联想，根据用户输入的文字给予提示，通过用户鼠标点击获得
    * 编辑范媛是，小区名不可修改
* 基本信息模块
    * 出租方式分整租与合租
    * 整套户型必须填写 ?室?厅?卫
        * 室必须在1—9之间
        * 厅必须在0—10之间
        * 卫必须在0—10之间
    * 楼层必须填写所在楼层和总楼层
        * 楼数可以为负数，表示地下楼层，但没有0层，最深为-9层
        * 总层数最大为99层
        * 所在楼层≤总层数
    * 房屋情况，包括类型、装修、朝向，k-v对应表见附录
        * 当<i>出租方式为合租时</i>，该栏<b>没有</b>朝向下拉框
    * 单间出租，当<i>出租方式为合租时</i>出现该栏，包括性别限制、单间朝向，k-v对应表见附录
    * 面积(平米)
        * 1 ≤ 整数 ≤ 9999
    * 租金(元/月)
        * 1 ≤ 整数 ≤ 999999
    * 房屋配置，k-v对应表见附录
* 详细信息模块
    该模块内容都必须经过过滤词逻辑过滤，所有违禁词、敏感词保存时转化成***代替
    * 房源标题
        * 5 ≤ 字数 ≤ 30
    * 房源描述(富文本框)
        * 1 ≤ 字数 ≤ 1000
* 上传图片模块
    * 暂无图片顺序调整功能，展示顺序按照上传顺序
    * 暂时只上传室内图，最多10张，可以不传
    * 图片可以设置或取消封面
    * 分辨率 > 400x315
    * 存储容量 < 2MB
* 协议
    * 阅读协议后(勾选我已经阅读并同意《安居客房源发布协议》)才可以点击推广、保存按钮
    * [《安居客房源发布协议》](http://shanghai.anjuke.com/help/question/554)
* 提交按钮
    * 推广
        * 新建房源、编辑房源页均提供推广按钮
    * 保存
        * 编辑推广中的房源时不存在保存按钮

---
### 设计

* 大业主发房功能分成前台控制器和提交控制器两个部分
    * 前台控制器负责承载页面和在编辑房源时输出原来的数据
    * 提交控制器负责获取、过滤、保存大业主编辑的房源内容，调用log、上下架逻辑

#### 前台控制器设计

* 略

#### 提交控制器设计

* check提交参数
* 初始化提交的数据
* 构造入库数据
* 插入/更新数据表以及相关操作
* 根据结果分发跳转

![提交控制器基本流程](http://gitlab.corp.anjuke.com/_site/docs/raw/master/DesignDoc/Sublessor/PropertySave_2014_9_26/saveprocess.png)