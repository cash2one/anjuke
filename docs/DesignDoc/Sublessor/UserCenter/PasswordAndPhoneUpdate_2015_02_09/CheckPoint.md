### 大业主用户中心项目check流程

* 大业主密码修改
    * 过程
        * 大业主输入旧密码 
            前端无特别操作;
            后端无特别操作;
        * 大业主输入新密码
            前端校验符合密码规则;
            后端无特别操作;
        * 大业主输入确认密码
            前端校验新密码是否匹配;
            后端无特别操作;
        * 大业主点击修改按钮
            前端提交表单到服务器;
            ```
            http://d.DEV_NAME.dev.anjuke.com/sublessor/server/pwd
            ```

post 参数

参数 | 类型 | 说明
--- | --- | ---
old | string | 旧密码
new | string | 新密码
confirm | string | 二次确认密码


后端检验<旧密码是否匹配>/<新密码是否符合密码规则>/<新密码和确认密码是否一致>/<返回修改成功/失败码>;

后端返回的结果一览

返回键 | 类型 | 说明
--- | --- | ---
status | int | 更新密码的返回状态


status 返回值说明表

value | explain
--- | ---
1 | 更新成功
0 | 更新失败
-1 | 传递方式不正确
-2 | 缺少必要参数
-3 | 确认密码与新密码不匹配
-4 | 超过最大长度
-5 | 小于最小长度
                

* 大业主手机修改
    * 过程
        * 大业主输入新手机号到密码框
            前端判断密码是否符合手机号规则;
            后端无特别操作;
        * 大业主点击发送验证码到新手机
            前端向对应新手机号发送验证码;
            ```
            http://d.DEV_NAME.dev.anjuke.com/sublessor/server/phone
            ```
post 参数

参数 | 类型 | 说明
--- | --- | ---
act | string | 请求操作{'verify', 'update'}
phone | int | 手机号
verify | string | 验证码


后端在得到指示后发送验证码到对应手机号;
            
后端返回结果一览

返回值 | 类型 | 说明
--- | --- | ---
act | string | 请求的电话操作{'':无法识别的操作请求, 'verify':请求发送验证码, 'update':更新用户手机}
new_utype | int | 新电话的用户类型检查结果，详细值见<new_utype说明表>
status | string | 请求返回的状态，详细值见<验证码请求status 说明表>


验证码请求status 说明表

value | explain
--- | ---
2 | 验证码校验不成功
1 | 发送成功
0 | 未发送
-1 | 请求太频繁 默认60秒
-2 | 达到同手机号每日上限 默认为5条


new_utype说明表

value | explain
--- | ---
0 | 未进行验证
1 | 未注册用户
2 | 普通用户
3 | 特殊用户
4 | 验证超时
5 | 电话格式错误


* 大业主输入验证码
    前端限制输入验证码的位数;
    后端无特别操作;
* 大业主点击修改手机号按钮
    前端提交表单到服务器;
    后端校验<新手机号符合手机号规范>/<新手机号未注册经纪人>/<验证码正确与否>/<修改用户中心及400绑定手机号>/<返回修改成功/失败>;

后端返回结果一览

返回值 | 类型 | 说明
--- | --- | ---
act | string | 请求的电话操作{'':无法识别的操作请求, 'verify':请求发送验证码, 'update':更新用户手机}
new_utype | int | 新电话的用户类型检查结果，详细值见<new_utype说明表>
status | string | 请求返回的状态，详细值见<update mobile status 说明表>


update mobile status 说明表

value | explain
--- | ---
0 | 未更新
1 | 更新成功
2 | 验证码校验错误


前端获取返回码后对应<跳转/停留在当前页>;


几个需要注意的实现点

```
1 用户的原手机号并不是由表单传递而是由当前登陆的用户id通过后端取得;
2 生成验证码不需要考虑唯一性，所以算法不应该过分设计;
3 验证码不需要入表入库，只需要使用memcache保存30分钟即可，根据需求每个memcache的过期时间可以设为1800秒，无其他限制。
  建议通手机号的发送间隔为1分钟，同手机号的发送条数限制为10条/天;
```
